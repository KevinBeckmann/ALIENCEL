<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Administrador | Painel</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

<style>
body { background:#111; color:white; font-family:Roboto; padding:20px; }
.container {
    max-width:900px; margin:auto; background:#1d1d1d; padding:25px;
    border-radius:10px; box-shadow:0 0 15px #000;
}
h1 { color:#00A65A; font-weight:300; }
input, select {
    width:100%; padding:10px; margin-top:8px; margin-bottom:15px;
    border:none; border-radius:6px; background:#333; color:white;
}
button {
    padding:10px 20px; border:none; border-radius:6px;
    background:#00A65A; color:white; cursor:pointer;
}
button:hover { background:#008b4d; }
table { width:100%; border-collapse:collapse; margin-top:20px; }
th, td { padding:12px; border-bottom:1px solid #333; }
.btn-edit { background:#3498db; }
.btn-delete { background:#e74c3c; }
.promobox { margin-top:25px; }
</style>
</head>
<body>

<div class="container">

    <h1>Painel Administrativo</h1>

    <h2>Adicionar / Editar Serviço</h2>

    <input type="hidden" id="id">

    <label>Cliente</label>
    <input type="text" id="cliente">

    <label>Status</label>
    <select id="status">
        <option value="Análise/Diagnóstico">Análise/Diagnóstico</option>
        <option value="Aguardando Aprovação">Aguardando Aprovação</option>
        <option value="Aguardando Peça">Aguardando Peça</option>
        <option value="Em Reparo">Em Reparo</option>
        <option value="Pronto para Retirada">Pronto para Retirada</option>
    </select>

    <label>Previsão</label>
    <input type="text" id="previsao">

    <button onclick="salvar()">Salvar</button>

    <h2>Serviços Cadastrados</h2>

    <table>
        <thead><tr><th>Cliente</th><th>Status</th><th>Previsão</th><th>Ações</th></tr></thead>
        <tbody id="lista"></tbody>
    </table>

    <div class="promobox">
        <h2>Promoções do Dia</h2>
        <textarea id="promo" style="width:100%;height:80px;background:#333;color:white;"></textarea>
        <button onclick="salvarPromo()">Salvar Promoções</button>
    </div>

</div>

<script src="dados.js"></script>

<script>

function carregar() {
    const lista = document.getElementById("lista");
    lista.innerHTML = "";

    getTabela().forEach((item, i) => {
        let tr = document.createElement("tr");

        tr.innerHTML = `
            <td>${item.cliente}</td>
            <td>${item.status}</td>
            <td>${item.previsao}</td>
            <td>
                <button class="btn-edit" onclick="editar(${i})">Editar</button>
                <button class="btn-delete" onclick="excluir(${i})">Excluir</button>
            </td>
        `;

        lista.appendChild(tr);
    });

    document.getElementById("promo").value = getPromocoes();
}

function salvar() {
    const id = document.getElementById("id").value;
    const cliente = document.getElementById("cliente").value;
    const status = document.getElementById("status").value;
    const previsao = document.getElementById("previsao").value;

    if (cliente.trim() === "") return alert("Preencha o cliente.");

    const db = getDB();

    if (id === "") {
        // adicionar
        db.tabela.push({ cliente, status, previsao });
    } else {
        // editar
        db.tabela[id] = { cliente, status, previsao };
    }

    saveDB(db);
    limpar();
    carregar();
}

function editar(i) {
    const item = getTabela()[i];
    document.getElementById("cliente").value = item.cliente;
    document.getElementById("status").value = item.status;
    document.getElementById("previsao").value = item.previsao;
    document.getElementById("id").value = i;
}

function excluir(i) {
    if (!confirm("Excluir registro?")) return;
    deleteLinha(i);
    carregar();
}

function limpar() {
    document.getElementById("id").value = "";
    document.getElementById("cliente").value = "";
    document.getElementById("previsao").value = "";
}

function salvarPromo() {
    setPromocoes(document.getElementById("promo").value);
    alert("Promoções atualizadas!");
}

carregar();

</script>

</body>
</html>
